<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>联系客服</title>
    <link rel="stylesheet" href="../css/index.css"/>
</head>
<body>
</body>

		<div class="chat">
	  	    <div class="chat_title">
	  	    	<div class="logo"></div>
	  	    	<div class="title"></div>
	  	    </div> 
	  		<div class="chat_content">
	  				<ul> 
	  					<li class="teacher_msg">
						  <div class="user-avatar"> <img src="https://fs-km.7moor.com/N00000021451/km/2018-08-30/1535629155660/52cdcfd0-ac49-11e8-b46c-47849b41fd55?imageView2/1/w/50/h/50" alt=""> </div>
						  <li class="student_msg">
								<div >
									42323432324
								</div>
							</li>
	  				
	  					</li>
	  					<li class="student_msg">
							<div class="user-avatar"> <img src="https://fs-km.7moor.com/N00000021451/km/2018-08-30/1535629155660/52cdcfd0-ac49-11e8-b46c-47849b41fd55?imageView2/1/w/50/h/50" alt=""> </div>
							<div >
	  							42323432324
	  						</div>
	  					</li>
	  				</ul>
	  		</div>
	  		<div class="chat_info">
<!--	  			 <div class="chat_tool"></div>-->
	  			 <div class="chat_input">
	  			 		<textarea  type="text" name="message">
	  			 			
	  			 		</textarea>
	  			 </div>	
	  			 <div class="send">
	  			 	 <button id="send_button">发送</button>
	  			 </div>
	  		</div>
	  </div>

	  </body>
<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.5.1.min.js"></script>
	<script type="text/javascript">

var wsServer = 'ws://120.27.249.4:3306';
        var websocket = new WebSocket(wsServer);

			$(function(){


				 $('#send_button').click(function(){
				 		var text1  = $("textarea[name='message']").val().replace(/(^\s*)|(\s*$)/g,"");
				 		if(text1 != ''){
				 				console.debug(1111);
				 			 $('.chat .chat_content ul').append('<li class="student_msg"><div>'+text1+'</div></li>');
				 			 $("textarea[name='message']").val('');
							 websocket.send(text1);
				 		}

				 });

			});

        websocket.onopen = function (evt) {
            console.debug("Connected to WebSocket server.");
        };

        websocket.onclose = function (evt) {
            console.debug("Disconnected");
        };

        websocket.onmessage = function (evt) {
	    $('.chat .chat_content ul').append('<li class="teacher_msg"><div>'+evt.data+'</div></li>');	
        };

        websocket.onerror = function (evt, e) {
        };
    </script>

</html>
